/*
 * Example - Running code on an ethereum-vm
 *
 *
 * To run this example in the browser, use the pre-bundled
 * version (bundle.js) or bundle it with browserify
 * `browserify index.js -o bundle.js` and then load
 * this folder onto a HTTP WebServer (such as node-static)
 */
var Buffer = require('safe-buffer').Buffer // use for Node.js <4.5.0
var VM = require('../../dist/index.js')

// create a new VM instance
var vm = new VM()

var code = '608060405234801561001057600080fd5b506101b3806100206000396000f3fe608060405234801561001057600080fd5b506004361061002b5760003560e01c80636b59084d14610030575b600080fd5b61003861003a565b005b600961005d604051806080016040528060428152602001610146604291396100d8565b61007e604051806080016040528060428152602001610104604291396100d8565b6040518083815260200182815260200192505050602060405180830381855afa1580156100af573d6000803e3d6000fd5b5050506040513d60208110156100c457600080fd5b810190808051906020019092919050505050565b600060608290506000815114156100f5576000801b9150506100fe565b60208301519150505b91905056fe307832396465386366323331646439633061393062353136656466373330356562363064653231383837393638646165366334633866316564663964346366663430307865383635353166396130626433633239636435333537356133363033363334313433356434306638366364613662613237646466656539363861306336313534a165627a7a7230582061a201738fc9979be0c4a55febd6d8a638d158a29202307265a4e7fa3e9e03a70029'

vm.on('step', function (data) {
  console.log(data.opcode.name)
})

vm.runCode({
  code: Buffer.from(code, 'hex'),
  gasLimit: Buffer.from('ffffffff', 'hex')
}, function (err, results) {
  console.log('returned: ' + results.return.toString('hex'))
  console.log('gasUsed: ' + results.gasUsed.toString())
  console.log(err)
})
